<% 
	require 'digest'
    require 'openssl'
    require 'json'
    require 'base64'
    require 'open-uri'
    @payeer = Payeer.new

    m_shop = ENV['ID_MERCHANT']
    m_orderid = @payeer.id
    m_amount = "100.00"
    m_curr = "RUB"
    m_desc = Base64.encode64('Text')
    m_key = "vksruu0m5qf49bqs"

    list_of_value_for_sign = [m_shop, m_orderid, m_amount, m_curr, m_desc, m_key]

    result_string = list_of_value_for_sign.join(":")

    # sign_hash = Digest::SHA256.digest result_string

    return @sign = Digest::SHA256.hexdigest(result_string).upcase!
%>

<%= @sign %>
<form method="post" action="https://payeer.com/merchant/">
	<input type="hidden" name="m_shop" value="<%= ENV['ID_MERCHANT'] %>">
	<input type="hidden" name="m_orderid" value="<%= @payeer.id %>">
	<input type="hidden" name="m_amount" value="<%= @payeer.total %>">
	<input type="hidden" name="m_curr" value="RUB">
	<input type="hidden" name="m_desc" value="<%= @payeer.description %>">
	<input type="hidden" name="m_sign" value="<%= @sign %>">

	<input type="submit" name="m_process" value="send" />
</form>

